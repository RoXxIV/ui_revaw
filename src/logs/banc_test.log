[2025-06-25 19:57:35] [INFO] EmailConfig: Configuration email chargée depuis C:\Users\RoXx\Desktop\Banc_final_pi\src\ui\email\email_config.json
[2025-06-25 19:57:35] [INFO] Démarrage du script d'écoute MQTT v3 (avec vérification statut)...
[2025-06-25 19:57:35] [WARNING] !!! ATTENTION: IP imprimante semble par défaut. Vérifiez si elle a changé. !!!
[2025-06-25 19:57:35] [INFO] Thread Worker d'impression démarré.
[2025-06-25 19:57:35] [INFO] Tentative de connexion au broker MQTT: localhost:1883
[2025-06-25 19:57:35] [INFO] Démarrage de la boucle MQTT (écoute en continu)...
[2025-06-25 19:57:35] [INFO] Connecté au broker MQTT localhost:1883
[2025-06-25 19:57:35] [INFO] DEBUG: MQTT_TOPIC_TEST_DONE = 'printer/test_done'
[2025-06-25 19:57:35] [INFO] Abonné aux topics: create, update_test_done, shipping, reprint_main, request_full_reprint, update_shipping_timestamp
[2025-06-25 19:57:50] [INFO] EmailConfig: Configuration email chargée depuis C:\Users\RoXx\Desktop\Banc_final_pi\src\ui\email\email_config.json
[2025-06-25 19:57:50] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 19:57:50] [INFO] UI: Interface pour banc1 créée avec succès.
[2025-06-25 19:57:50] [INFO] UI: Interface pour banc2 créée avec succès.
[2025-06-25 19:57:50] [INFO] UI: Interface pour banc3 créée avec succès.
[2025-06-25 19:57:50] [INFO] UI: Interface pour banc4 créée avec succès.
[2025-06-25 19:57:50] [INFO] ScanManager initialisé
[2025-06-25 19:57:50] [INFO] UI: ScanManager initialisé
[2025-06-25 19:57:50] [INFO] UI: Démarrage de la boucle principale Tkinter (mainloop).
[2025-06-25 19:57:50] [INFO] UI: Tentative de connexion au broker MQTT...
[2025-06-25 19:57:50] [INFO] UI: Connexion MQTT établie. Démarrage boucle de réception.
[2025-06-25 19:57:50] [INFO] UI: Connecté avec le code 0 
[2025-06-25 19:57:50] [INFO] UI: Connexion MQTT réussie. Tentative d'abonnements...
[2025-06-25 19:57:50] [INFO] UI: Abonnements MQTT terminés.
[2025-06-25 19:58:21] [INFO] UI: Prompt reçu: banc1
[2025-06-25 19:58:21] [INFO] ScanManager: Traitement scan 'banc1' dans état 0
[2025-06-25 19:58:22] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 19:58:25] [INFO] UI: Prompt reçu: RW-48v2710002
[2025-06-25 19:58:25] [INFO] ScanManager: Traitement scan 'RW-48v2710002' dans état 1
[2025-06-25 19:58:25] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 19:58:25] [INFO] DataOps: Batterie RW-48v2710002 validée par 'toto'.
[2025-06-25 19:58:25] [INFO] ScanManager: Batterie RW-48v2710002 validée pour banc libre
[2025-06-25 19:58:29] [INFO] UI: Prompt reçu: banc1
[2025-06-25 19:58:29] [INFO] ScanManager: Traitement scan 'banc1' dans état 2
[2025-06-25 19:58:30] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 19:58:30] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 19:58:30] [INFO] ScanManager: Chemin batterie stocké pour banc1: data\banc1\25062025-RW-48v2710002
[2025-06-25 19:58:30] [INFO] ScanManager: Lancement subprocess: C:\Users\RoXx\AppData\Local\Programs\Python\Python311\python.exe C:\Users\RoXx\Desktop\Banc_final_pi\banc.py banc1 RW-48v2710002
[2025-06-25 19:58:30] [INFO] EmailConfig: Configuration email chargée depuis C:\Users\RoXx\Desktop\Banc_final_pi\src\ui\email\email_config.json
[2025-06-25 19:58:30] [INFO] banc1: Aucun dossier existant trouvé, utilisera/créera: data\banc1\25062025-RW-48v2710002
[2025-06-25 19:58:30] [INFO] banc1: Création config.json par défaut dans data\banc1\25062025-RW-48v2710002
[2025-06-25 19:58:30] [INFO] banc1: Répertoire principal 'data' créé.
[2025-06-25 19:58:30] [INFO] banc1: Sous-répertoire 'data\banc1' créé.
[2025-06-25 19:58:30] [INFO] banc1: Fichier config.json créé avec succès.
[2025-06-25 19:58:30] [INFO] banc1: Le fichier data\banc1\25062025-RW-48v2710002\data.csv n'existe pas, tentative de création.
[2025-06-25 19:58:30] [INFO] banc1: Fichier data\banc1\25062025-RW-48v2710002\data.csv créé avec succès.
[2025-06-25 19:58:30] [INFO] banc1: Prêt à démarrer pour RW-48v2710002 dans data\banc1\25062025-RW-48v2710002
[2025-06-25 19:58:30] [INFO] banc1: Étape initiale (depuis config): 1
[2025-06-25 19:58:30] [INFO] banc1: Connexion à MQTT (localhost:1883)...
[2025-06-25 19:58:30] [INFO] banc1: Abonnements MQTT réussis.
[2025-06-25 19:58:30] [INFO] banc1: État initial publié sur banc1/command: {"current_step": 1, "capacity_ah": 0, "capacity_wh": 0}
[2025-06-25 19:58:30] [INFO] banc1: Ouverture du fichier CSV en mode append: data\banc1\25062025-RW-48v2710002\data.csv
[2025-06-25 19:58:30] [INFO] banc1: Démarrage du thread de surveillance d'activité BMS...
[2025-06-25 19:58:30] [INFO] banc1: Thread surveillance activité BMS démarré (Timeout: 30s, Check: 10s).
[2025-06-25 19:58:30] [INFO] banc1: Démarrage de la boucle MQTT (loop_forever)...
[2025-06-25 19:59:00] [ERROR] banc1: TIMEOUT - Aucune donnée BMS reçue depuis 30 secondes!
[2025-06-25 19:59:00] [INFO] banc1: Alerte Timeout publiée sur banc1/security
[2025-06-25 19:59:11] [INFO] Current step mis à jour: 1, pour banc1
[2025-06-25 19:59:11] [INFO] UI: banc1 current_step (UI) mis à jour: 1
[2025-06-25 19:59:11] [INFO] banc1: Fichier data\banc1\25062025-RW-48v2710002\config.json mis à jour: current_step=1
[2025-06-25 19:59:11] [INFO] AnimationManager: Démarrage animation phase 1 pour banc1
[2025-06-25 19:59:11] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 19:59:11] [INFO] ConfigManager: bancs_config.json mis à jour pour banc1 avec current_step=1
[2025-06-25 19:59:17] [INFO] banc1: Commande d'arrêt manuel (Step 9) reçue via MQTT.
[2025-06-25 19:59:17] [INFO] UI: Step 9 reçu pour banc1. Arrêt timer et correction label phase.
[2025-06-25 19:59:17] [INFO] banc1: Fichier CSV fermé.
[2025-06-25 19:59:17] [INFO] banc1: Fichier CSV fermé suite à la commande d'arrêt manuel (Step 9).
[2025-06-25 19:59:17] [INFO] banc1: Arrêt du processus demandé par Step 9.
[2025-06-25 19:59:17] [ERROR] banc1: *** FIN DU BLOC FINALLY. global_mqtt_config VA RETOURNER. ***
[2025-06-25 19:59:27] [INFO] UI: Prompt reçu: banc1
[2025-06-25 19:59:27] [INFO] ScanManager: Traitement scan 'banc1' dans état 0
[2025-06-25 19:59:28] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 19:59:31] [INFO] UI: Prompt reçu: RW-48v2710002
[2025-06-25 19:59:31] [INFO] ScanManager: Traitement scan 'RW-48v2710002' dans état 1
[2025-06-25 19:59:31] [INFO] DataOps: Batterie RW-48v2710002 validée par 'toto'.
[2025-06-25 19:59:31] [INFO] ScanManager: Serial correct et batterie RW-48v2710002 validée
[2025-06-25 19:59:34] [INFO] UI: Prompt reçu: banc1
[2025-06-25 19:59:34] [INFO] ScanManager: Traitement scan 'banc1' dans état 2
[2025-06-25 19:59:35] [INFO] ScanManager: Lancement subprocess: C:\Users\RoXx\AppData\Local\Programs\Python\Python311\python.exe C:\Users\RoXx\Desktop\Banc_final_pi\banc.py banc1 RW-48v2710002
[2025-06-25 19:59:35] [INFO] EmailConfig: Configuration email chargée depuis C:\Users\RoXx\Desktop\Banc_final_pi\src\ui\email\email_config.json
[2025-06-25 19:59:35] [INFO] banc1: Configuration existante chargée depuis data\banc1\25062025-RW-48v2710002\config.json
[2025-06-25 19:59:35] [INFO] banc1: Prêt à démarrer pour RW-48v2710002 dans data\banc1\25062025-RW-48v2710002
[2025-06-25 19:59:35] [INFO] banc1: Étape initiale (depuis config): 1
[2025-06-25 19:59:35] [INFO] banc1: Connexion à MQTT (localhost:1883)...
[2025-06-25 19:59:35] [INFO] banc1: Abonnements MQTT réussis.
[2025-06-25 19:59:35] [INFO] banc1: État initial publié sur banc1/command: {"current_step": 1, "capacity_ah": 0, "capacity_wh": 0}
[2025-06-25 19:59:35] [INFO] banc1: Ouverture du fichier CSV en mode append: data\banc1\25062025-RW-48v2710002\data.csv
[2025-06-25 19:59:35] [INFO] banc1: Démarrage du thread de surveillance d'activité BMS...
[2025-06-25 19:59:35] [INFO] banc1: Thread surveillance activité BMS démarré (Timeout: 30s, Check: 10s).
[2025-06-25 19:59:35] [INFO] banc1: Démarrage de la boucle MQTT (loop_forever)...
[2025-06-25 19:59:39] [INFO] Current step mis à jour: 1, pour banc1
[2025-06-25 19:59:39] [INFO] UI: banc1 current_step (UI) mis à jour: 1
[2025-06-25 19:59:39] [INFO] AnimationManager: Démarrage animation phase 1 pour banc1
[2025-06-25 19:59:39] [INFO] banc1: Fichier data\banc1\25062025-RW-48v2710002\config.json mis à jour: current_step=1
[2025-06-25 19:59:39] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 19:59:39] [INFO] ConfigManager: bancs_config.json mis à jour pour banc1 avec current_step=1
[2025-06-25 19:59:43] [INFO] Current step mis à jour: 2, pour banc1
[2025-06-25 19:59:43] [INFO] UI: banc1 current_step (UI) mis à jour: 2
[2025-06-25 19:59:43] [INFO] UI: Étape 2 détectée pour banc1. Planification MAJ Ri/Diffusion UI.
[2025-06-25 19:59:43] [INFO] DataOps: Chargement à la demande des coefficients de température...
[2025-06-25 19:59:43] [INFO] banc1: Fichier data\banc1\25062025-RW-48v2710002\config.json mis à jour: current_step=2
[2025-06-25 19:59:43] [INFO] DataOps: Coefficients température chargés : 31 valeurs
[2025-06-25 19:59:43] [INFO] UIUpdater: Ri/Diffusion mis à jour pour banc1: Ri=0.00 mΩ, Diff=0.00 mΩ
[2025-06-25 19:59:43] [INFO] AnimationManager: Démarrage animation phase 2 pour banc1
[2025-06-25 19:59:43] [INFO] DataOps: Chargement à la demande du profil de charge...
[2025-06-25 19:59:43] [INFO] DataOps: 1001 lignes lues depuis C:\Users\RoXx\Desktop\Banc_final_pi\src\ui\charge_profile.csv.
[2025-06-25 19:59:43] [INFO] DataOps: Profil de charge trié et chargé (1001 points valides).
[2025-06-25 19:59:43] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 19:59:43] [INFO] ConfigManager: bancs_config.json mis à jour pour banc1 avec current_step=2
[2025-06-25 19:59:46] [INFO] Current step mis à jour: 3, pour banc1
[2025-06-25 19:59:46] [INFO] UI: banc1 current_step (UI) mis à jour: 3
[2025-06-25 19:59:46] [INFO] AnimationManager: Démarrage animation phase 3 pour banc1
[2025-06-25 19:59:46] [INFO] banc1: Fichier data\banc1\25062025-RW-48v2710002\config.json mis à jour: current_step=3
[2025-06-25 19:59:46] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 19:59:46] [INFO] ConfigManager: bancs_config.json mis à jour pour banc1 avec current_step=3
[2025-06-25 19:59:47] [INFO] AnimationManager: Phase 3 animation terminée pour banc1
[2025-06-25 19:59:50] [INFO] Current step mis à jour: 4, pour banc1
[2025-06-25 19:59:50] [INFO] UI: banc1 current_step (UI) mis à jour: 4
[2025-06-25 19:59:50] [INFO] AnimationManager: Démarrage animation phase 4 pour banc1
[2025-06-25 19:59:50] [INFO] banc1: Fichier data\banc1\25062025-RW-48v2710002\config.json mis à jour: current_step=4
[2025-06-25 19:59:50] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 19:59:50] [INFO] ConfigManager: bancs_config.json mis à jour pour banc1 avec current_step=4
[2025-06-25 20:00:00] [INFO] UI: Step 6 (Test ÉCHOUÉ) reçu pour banc1. Arrêt timer et MàJ UI.
[2025-06-25 20:00:00] [INFO] banc1: Finalisation du test pour gestion nourrice, puis archivage des données et reset du banc.
[2025-06-25 20:00:00] [INFO] banc1: Fichier CSV fermé.
[2025-06-25 20:00:00] [INFO] banc1: Fichier CSV fermé pour test échoué.
[2025-06-25 20:00:00] [INFO] banc1: Dossier de test data\banc1\25062025-RW-48v2710002 archivé dans data/archive_fails\25062025-RW-48v2710002
[2025-06-25 20:00:00] [INFO] banc1 réinitialisé dans bancs_config.json
[2025-06-25 20:00:00] [INFO] banc1: Configuration du banc réinitialisée dans bancs_config.json après échec.
[2025-06-25 20:00:00] [INFO] banc1: Fin du script banc.py suite à Step 6 (Test Échoué).
[2025-06-25 20:00:00] [ERROR] banc1: *** FIN DU BLOC FINALLY. global_mqtt_config VA RETOURNER. ***
[2025-06-25 20:00:00] [INFO] UI: Traitement pour Step 6 (Test Échoué) terminé pour banc1.
[2025-06-25 20:00:17] [INFO] UI: Prompt reçu: banc1
[2025-06-25 20:00:17] [INFO] ScanManager: Traitement scan 'banc1' dans état 0
[2025-06-25 20:00:18] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 20:00:20] [INFO] UI: Prompt reçu: RW-48v2710002
[2025-06-25 20:00:20] [INFO] ScanManager: Traitement scan 'RW-48v2710002' dans état 1
[2025-06-25 20:00:20] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 20:00:20] [INFO] DataOps: Batterie RW-48v2710002 validée par 'toto'.
[2025-06-25 20:00:20] [INFO] ScanManager: Batterie RW-48v2710002 validée pour banc libre
[2025-06-25 20:00:25] [INFO] UI: Prompt reçu: banc1
[2025-06-25 20:00:25] [INFO] ScanManager: Traitement scan 'banc1' dans état 2
[2025-06-25 20:00:26] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 20:00:26] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 20:00:26] [INFO] ScanManager: Chemin batterie stocké pour banc1: data\banc1\25062025-RW-48v2710002
[2025-06-25 20:00:26] [INFO] ScanManager: Lancement subprocess: C:\Users\RoXx\AppData\Local\Programs\Python\Python311\python.exe C:\Users\RoXx\Desktop\Banc_final_pi\banc.py banc1 RW-48v2710002
[2025-06-25 20:00:26] [INFO] EmailConfig: Configuration email chargée depuis C:\Users\RoXx\Desktop\Banc_final_pi\src\ui\email\email_config.json
[2025-06-25 20:00:26] [INFO] banc1: Aucun dossier existant trouvé, utilisera/créera: data\banc1\25062025-RW-48v2710002
[2025-06-25 20:00:26] [INFO] banc1: Création config.json par défaut dans data\banc1\25062025-RW-48v2710002
[2025-06-25 20:00:26] [INFO] banc1: Fichier config.json créé avec succès.
[2025-06-25 20:00:26] [INFO] banc1: Le fichier data\banc1\25062025-RW-48v2710002\data.csv n'existe pas, tentative de création.
[2025-06-25 20:00:26] [INFO] banc1: Fichier data\banc1\25062025-RW-48v2710002\data.csv créé avec succès.
[2025-06-25 20:00:26] [INFO] banc1: Prêt à démarrer pour RW-48v2710002 dans data\banc1\25062025-RW-48v2710002
[2025-06-25 20:00:26] [INFO] banc1: Étape initiale (depuis config): 1
[2025-06-25 20:00:26] [INFO] banc1: Connexion à MQTT (localhost:1883)...
[2025-06-25 20:00:26] [INFO] banc1: Abonnements MQTT réussis.
[2025-06-25 20:00:26] [INFO] banc1: État initial publié sur banc1/command: {"current_step": 1, "capacity_ah": 0, "capacity_wh": 0}
[2025-06-25 20:00:26] [INFO] banc1: Ouverture du fichier CSV en mode append: data\banc1\25062025-RW-48v2710002\data.csv
[2025-06-25 20:00:26] [INFO] banc1: Démarrage du thread de surveillance d'activité BMS...
[2025-06-25 20:00:26] [INFO] banc1: Thread surveillance activité BMS démarré (Timeout: 30s, Check: 10s).
[2025-06-25 20:00:26] [INFO] banc1: Démarrage de la boucle MQTT (loop_forever)...
[2025-06-25 20:00:33] [INFO] Current step mis à jour: 1, pour banc1
[2025-06-25 20:00:33] [INFO] UI: banc1 current_step (UI) mis à jour: 1
[2025-06-25 20:00:33] [INFO] AnimationManager: Démarrage animation phase 1 pour banc1
[2025-06-25 20:00:33] [INFO] banc1: Fichier data\banc1\25062025-RW-48v2710002\config.json mis à jour: current_step=1
[2025-06-25 20:00:33] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 20:00:33] [INFO] ConfigManager: bancs_config.json mis à jour pour banc1 avec current_step=1
[2025-06-25 20:00:38] [INFO] UI: Résultats RI/Diffusion disponibles pour banc1. (MAJ via step 2)
[2025-06-25 20:00:38] [INFO] banc1: Données RI reçues: {'ri_discharge_average': 0.24781, 'diffusion_discharge_average': 0.213292, 'ri_charge_average': 0.30423, 'diffusion_charge_average': 0.20282, 'delta_ri_cells': [0.00012, 0.00013, 0.00011, 0.00012, 0.00014, 0.00013, 0.00012, 0.00015, 0.00011, 0.00012, 0.00013, 0.00014, 0.00012, 0.00013, 0.00011], 'delta_diffusion_cells': [5e-05, 6e-05, 5e-05, 5e-05, 6e-05, 7e-05, 5e-05, 6e-05, 5e-05, 5e-05, 6e-05, 6e-05, 5e-05, 5e-05, 4e-05]}
[2025-06-25 20:00:38] [INFO] banc1: config.json mis à jour avec les résultats RI: ['ri_discharge_average', 'ri_charge_average', 'diffusion_discharge_average', 'diffusion_charge_average', 'delta_ri_cells', 'delta_diffusion_cells']
[2025-06-25 20:00:41] [INFO] Current step mis à jour: 2, pour banc1
[2025-06-25 20:00:41] [INFO] UI: banc1 current_step (UI) mis à jour: 2
[2025-06-25 20:00:41] [INFO] UI: Étape 2 détectée pour banc1. Planification MAJ Ri/Diffusion UI.
[2025-06-25 20:00:41] [INFO] banc1: Fichier data\banc1\25062025-RW-48v2710002\config.json mis à jour: current_step=2
[2025-06-25 20:00:41] [INFO] UIUpdater: Ri/Diffusion mis à jour pour banc1: Ri=276.02 mΩ, Diff=208.06 mΩ
[2025-06-25 20:00:41] [INFO] AnimationManager: Démarrage animation phase 2 pour banc1
[2025-06-25 20:00:41] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 20:00:41] [INFO] ConfigManager: bancs_config.json mis à jour pour banc1 avec current_step=2
[2025-06-25 20:00:44] [INFO] Current step mis à jour: 3, pour banc1
[2025-06-25 20:00:44] [INFO] UI: banc1 current_step (UI) mis à jour: 3
[2025-06-25 20:00:44] [INFO] AnimationManager: Démarrage animation phase 3 pour banc1
[2025-06-25 20:00:44] [INFO] banc1: Fichier data\banc1\25062025-RW-48v2710002\config.json mis à jour: current_step=3
[2025-06-25 20:00:44] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 20:00:44] [INFO] ConfigManager: bancs_config.json mis à jour pour banc1 avec current_step=3
[2025-06-25 20:00:45] [INFO] AnimationManager: Phase 3 animation terminée pour banc1
[2025-06-25 20:00:47] [INFO] UI: banc1 current_step (UI) mis à jour: 4
[2025-06-25 20:00:47] [INFO] AnimationManager: Démarrage animation phase 4 pour banc1
[2025-06-25 20:00:47] [INFO] banc1: Fichier data\banc1\25062025-RW-48v2710002\config.json mis à jour: current_step=4
[2025-06-25 20:00:47] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 20:00:47] [INFO] ConfigManager: bancs_config.json mis à jour pour banc1 avec current_step=4
[2025-06-25 20:00:51] [INFO] banc1: *** STEP 5 DETECTE - DEBUT TRAITEMENT - TEST TERMINE ***
[2025-06-25 20:00:51] [INFO] UI: banc1 current_step (UI) mis à jour: 5
[2025-06-25 20:00:51] [INFO] UI: Toutes les phases finalisées pour banc1
[2025-06-25 20:00:51] [INFO] banc1: Fichier data\banc1\25062025-RW-48v2710002\config.json mis à jour: current_step=5
[2025-06-25 20:00:51] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 20:00:51] [INFO] ConfigManager: bancs_config.json mis à jour pour banc1 avec current_step=5
[2025-06-25 20:00:51] [INFO] banc1 réinitialisé dans bancs_config.json
[2025-06-25 20:00:52] [INFO] banc1: *** DEBUT ENVOI VERS PRINTER.PY ***
[2025-06-25 20:00:52] [INFO] banc1: Service d'impression détecté. Envoi des tâches à printer.py.
[2025-06-25 20:00:52] [INFO] banc1: *** PAYLOAD PREPARE: {"serial_number": "RW-48v2710002", "timestamp_test_done": "2025-06-25T20:00:51.866634"} ***
[2025-06-25 20:00:52] [INFO] banc1: *** CLIENT MQTT CONNECTE - ENVOI EN COURS ***
[2025-06-25 20:00:52] [INFO] banc1: Résultat publish tâche consolidée (printer/test_done): 0, MID: 3
[2025-06-25 20:00:52] [INFO] banc1: *** FIN ENVOI VERS PRINTER.PY ***
[2025-06-25 20:00:52] [INFO] banc1: Fichier CSV fermé.
[2025-06-25 20:00:52] [INFO] banc1: Fichier CSV fermé après envoi des données.
[2025-06-25 20:00:56] [ERROR] banc1: TIMEOUT - Aucune donnée BMS reçue depuis 30 secondes!
[2025-06-25 20:00:56] [INFO] banc1: Alerte Timeout publiée sur banc1/security
[2025-06-25 20:00:57] [INFO] banc1: Nettoyage terminé. sys.exit() va fermer la connexion.
[2025-06-25 20:00:57] [INFO] banc1: Fin du processus (appel à sys.exit(0)).
[2025-06-25 20:00:57] [ERROR] banc1: *** FIN DU BLOC FINALLY. global_mqtt_config VA RETOURNER. ***
[2025-06-25 20:00:57] [INFO] Message reçu sur 'printer/test_done': {"serial_number": "RW-48v2710002", "timestamp_test_done": "2025-06-25T20:00:51.866634"}
[2025-06-25 20:00:57] [INFO] DEBUG: Handler trouvé: True
[2025-06-25 20:00:57] [INFO] Traitement consolidé pour test_done S/N RW-48v2710002 à 2025-06-25T20:00:51.866634
[2025-06-25 20:00:57] [INFO] Ligne pour RW-48v2710002 marquée avec TimestampTestDone: 2025-06-25T20:00:51.866634
[2025-06-25 20:00:57] [INFO] Fichier CSV 'printed_serials.csv' mis à jour avec TimestampTestDone pour RW-48v2710002.
[2025-06-25 20:00:57] [INFO] Action 1 (test_done): CSV mis à jour pour RW-48v2710002
[2025-06-25 20:00:57] [INFO] Action 2 (test_done): Étiquette carton pour 'RW-48v2710002' ajoutée à la file. Taille: 1
[2025-06-25 20:00:57] [INFO] Détails trouvés pour réimpression de RW-48v2710002: QR Code QW7iZA, TimestampImpression 2025-06-25T19:51:22.710692
[2025-06-25 20:00:57] [INFO] Action 3 (test_done): Réimpression étiquette QR standard pour 'RW-48v2710002' (QR: QW7iZA) ajoutée à la file. Taille: 2
[2025-06-25 20:00:58] [INFO] Traitement de la file: PRINT_SHIPPING pour RW-48v2710002. QR: None, DateFab: None. File=2
[2025-06-25 20:01:01] [ERROR] Timeout lors de la connexion initiale à 192.168.1.100:9100 pour statut.
[2025-06-25 20:01:01] [INFO] Statut Imprimante déterminé: ERROR_COMM
[2025-06-25 20:01:01] [WARNING] Impossible de vérifier statut pour RW-48v2710002 (PRINT_SHIPPING) (Erreur Comm). Retenté.
[2025-06-25 20:01:11] [INFO] Traitement de la file: PRINT_SHIPPING pour RW-48v2710002. QR: None, DateFab: None. File=2
[2025-06-25 20:01:14] [ERROR] Timeout lors de la connexion initiale à 192.168.1.100:9100 pour statut.
[2025-06-25 20:01:14] [INFO] Statut Imprimante déterminé: ERROR_COMM
[2025-06-25 20:01:14] [WARNING] Impossible de vérifier statut pour RW-48v2710002 (PRINT_SHIPPING) (Erreur Comm). Retenté.
[2025-06-25 20:01:24] [INFO] Traitement de la file: PRINT_SHIPPING pour RW-48v2710002. QR: None, DateFab: None. File=2
[2025-06-25 20:01:26] [INFO] UI: Prompt reçu: banc1
[2025-06-25 20:01:26] [INFO] ScanManager: Traitement scan 'banc1' dans état 0
[2025-06-25 20:01:26] [INFO] ConfigManager: Configuration chargée depuis bancs_config.json
[2025-06-25 20:01:27] [ERROR] Timeout lors de la connexion initiale à 192.168.1.100:9100 pour statut.
[2025-06-25 20:01:27] [INFO] Statut Imprimante déterminé: ERROR_COMM
[2025-06-25 20:01:27] [WARNING] Impossible de vérifier statut pour RW-48v2710002 (PRINT_SHIPPING) (Erreur Comm). Retenté.
[2025-06-25 20:01:31] [INFO] UI: Application terminée.
[2025-06-25 20:01:37] [INFO] Traitement de la file: PRINT_SHIPPING pour RW-48v2710002. QR: None, DateFab: None. File=2
[2025-06-25 20:01:40] [ERROR] Timeout lors de la connexion initiale à 192.168.1.100:9100 pour statut.
[2025-06-25 20:01:40] [INFO] Statut Imprimante déterminé: ERROR_COMM
[2025-06-25 20:01:40] [WARNING] Impossible de vérifier statut pour RW-48v2710002 (PRINT_SHIPPING) (Erreur Comm). Retenté.
